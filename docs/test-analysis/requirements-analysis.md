# 要件分析書
## ShopTodo E2Eテスト練習用アプリケーション

---

### 文書情報
- **文書ID**: REQ-001
- **版数**: 1.0
- **作成日**: 2025-09-21
- **作成者**: Claude Code
- **承認者**: Project Team
- **最終更新**: 2025-09-21
- **関連文書**: テスト戦略書(TS-001), テスト計画書(TP-001)

---

## 1. 要件分析概要

### 1.1 目的
ShopTodoアプリケーションの機能要件・非機能要件を分析し、テストベースを特定する。

### 1.2 分析範囲
- 機能要件: ユーザー操作可能な全機能
- 非機能要件: 性能、使いやすさ、互換性、セキュリティ
- 制約条件: 技術制約、ビジネス制約

### 1.3 分析手法
- 既存実装の逆工程分析
- ユーザーシナリオベース分析
- ISTQB要件分析技法の適用

---

## 2. システム概要

### 2.1 システム目的
**主目的**: E2Eテスト学習・練習のためのWebアプリケーション
**副目的**: 実際のECサイト機能のシンプル実装例提供

### 2.2 ユーザー種別
- **学習者**: E2Eテストを学習する開発者・QAエンジニア
- **講師**: テスト研修で使用する指導者
- **システム**: 自動テストツール・CI/CDシステム

### 2.3 システム境界
- **対象範囲**: フロントエンド機能（SPA）
- **対象外**: バックエンドAPI、外部決済連携、実際の商品管理

---

## 3. 機能要件分析

### 3.1 認証機能

#### FR-001: ログイン機能
- **要件ID**: FR-001
- **要件名**: デモユーザーログイン
- **説明**: 固定認証情報でのログイン機能
- **前提条件**: アプリケーションアクセス済み
- **入力**: ユーザー名、パスワード
- **処理**:
  1. 入力値検証
  2. 固定認証情報との照合（demo/password）
  3. 認証成功時：ユーザー情報をlocalStorageに保存
  4. UI状態更新（ログインボタン→ユーザー情報表示）
- **出力**: 認証結果（成功/失敗）、UI状態変更
- **例外**:
  - 無効な認証情報入力時：エラーメッセージ表示
  - 空文字入力時：フォームバリデーション
- **業務ルール**:
  - 有効認証情報: username="demo", password="password"
  - 認証情報は大小文字区別
- **優先度**: 高（他機能の前提条件）

#### FR-002: ログアウト機能
- **要件ID**: FR-002
- **要件名**: ユーザーログアウト
- **説明**: ログイン状態の解除と関連データクリア
- **前提条件**: ログイン済み状態
- **入力**: ログアウトボタン押下
- **処理**:
  1. localStorage内のユーザー情報削除
  2. カート・Todo情報クリア
  3. UI状態をログアウト状態に復元
- **出力**: ログアウト完了メッセージ、UI状態変更
- **業務ルール**: ログアウト時は全セッションデータを削除
- **優先度**: 高

#### FR-003: セッション復元機能
- **要件ID**: FR-003
- **要件名**: ページリロード時のセッション復元
- **説明**: ページリロード後にログイン状態を復元
- **前提条件**: 過去にログイン実行済み
- **入力**: ページアクセス・リロード
- **処理**:
  1. localStorage内のセッション情報確認
  2. 有効な場合：ログイン状態復元
  3. 無効な場合：ログアウト状態維持
- **出力**: セッション状態（ログイン/ログアウト）
- **優先度**: 中

### 3.2 商品カタログ機能

#### FR-004: 商品一覧表示機能
- **要件ID**: FR-004
- **要件名**: 商品一覧表示
- **説明**: 12種類の固定商品の一覧表示
- **前提条件**: アプリケーションアクセス済み
- **入力**: ページアクセス
- **処理**:
  1. 商品マスターデータ読み込み
  2. 商品カード形式で一覧表示
  3. 各商品に価格、カテゴリ、画像プレースホルダー表示
- **出力**: 商品一覧画面
- **業務ルール**:
  - 商品数: 固定12商品
  - 表示項目: 商品名、価格、カテゴリ、画像、追加ボタン
- **優先度**: 高

#### FR-005: 商品検索機能
- **要件ID**: FR-005
- **要件名**: 商品名部分一致検索
- **説明**: 入力キーワードによる商品名検索
- **前提条件**: 商品一覧表示済み
- **入力**: 検索キーワード（テキスト）
- **処理**:
  1. 入力値を取得
  2. 商品名との部分一致判定（大小文字区別なし）
  3. 該当商品のフィルタリング表示
- **出力**: 検索結果商品一覧
- **業務ルール**:
  - 検索対象: 商品名のみ
  - 検索方式: 部分一致、大小文字区別なし
  - 空文字時: 全商品表示
- **優先度**: 中

#### FR-006: カテゴリフィルタ機能
- **要件ID**: FR-006
- **要件名**: カテゴリ別商品フィルタ
- **説明**: カテゴリ選択による商品絞り込み
- **前提条件**: 商品一覧表示済み
- **入力**: カテゴリ選択（electronics, clothing, books, home）
- **処理**:
  1. 選択カテゴリ取得
  2. 該当カテゴリ商品のフィルタリング
  3. フィルタ結果の表示更新
- **出力**: カテゴリ別商品一覧
- **業務ルール**:
  - カテゴリ種別: electronics, clothing, books, home
  - "すべてのカテゴリ"選択時: フィルタ解除
- **優先度**: 中

#### FR-007: 商品ソート機能
- **要件ID**: FR-007
- **要件名**: 商品並び替え
- **説明**: 指定条件による商品の並び替え
- **前提条件**: 商品一覧表示済み
- **入力**: ソート条件選択（名前順、価格昇順、価格降順）
- **処理**:
  1. ソート条件取得
  2. 条件に応じた商品並び替え
  3. ソート結果の表示更新
- **出力**: ソートされた商品一覧
- **業務ルール**:
  - 名前順: 商品名の辞書順（昇順）
  - 価格昇順: 価格の数値順（安い→高い）
  - 価格降順: 価格の数値順（高い→安い）
- **優先度**: 低

### 3.3 ショッピングカート機能

#### FR-008: カート商品追加機能
- **要件ID**: FR-008
- **要件名**: 商品のカート追加
- **説明**: 選択商品をショッピングカートに追加
- **前提条件**: ログイン済み、商品一覧表示済み
- **入力**: 商品の「カートに追加」ボタン押下
- **処理**:
  1. ログイン状態確認
  2. 商品情報取得
  3. カート内同一商品確認
  4. 新規商品の場合：数量1で追加
  5. 既存商品の場合：数量+1
  6. カート表示更新
- **出力**: カート更新、追加完了メッセージ
- **例外**: 未ログイン時：エラーメッセージ
- **業務ルール**:
  - ログイン必須機能
  - 同一商品は数量加算方式
- **優先度**: 高

#### FR-009: カート数量変更機能
- **要件ID**: FR-009
- **要件名**: カート内商品数量変更
- **説明**: カート内商品の数量増減操作
- **前提条件**: カートに商品が追加済み
- **入力**: +/-ボタン押下
- **処理**:
  1. 対象商品の現在数量取得
  2. +1または-1の数量変更
  3. 数量0の場合：商品をカートから削除
  4. カート合計金額再計算
  5. 表示更新
- **出力**: 数量変更、合計金額更新
- **業務ルール**:
  - 最小数量: 0（0で自動削除）
  - 最大数量: 制限なし
- **優先度**: 高

#### FR-010: カート商品削除機能
- **要件ID**: FR-010
- **要件名**: カートからの商品削除
- **説明**: カート内の特定商品を完全削除
- **前提条件**: カートに商品が追加済み
- **入力**: 削除ボタン（🗑️）押下
- **処理**:
  1. 対象商品をカートから削除
  2. カート合計金額再計算
  3. 表示更新
- **出力**: 商品削除、削除完了メッセージ
- **優先度**: 中

#### FR-011: カート合計計算機能
- **要件ID**: FR-011
- **要件名**: カート合計金額計算
- **説明**: カート内全商品の合計金額算出
- **前提条件**: カートに商品が存在
- **入力**: カート状態変更（追加・削除・数量変更）
- **処理**:
  1. カート内全商品取得
  2. 各商品の（価格×数量）計算
  3. 全商品の合計値算出
  4. 表示フォーマット（¥N,NNN形式）
- **出力**: 合計金額表示
- **業務ルール**:
  - 計算式: Σ(商品価格×数量)
  - 表示形式: ¥区切り表示
- **優先度**: 高

#### FR-012: チェックアウト機能
- **要件ID**: FR-012
- **要件名**: 購入手続き処理
- **説明**: カート内商品の購入完了処理（シミュレーション）
- **前提条件**: カートに商品が存在
- **入力**: チェックアウトボタン押下
- **処理**:
  1. 合計金額確認ダイアログ表示
  2. 確認時：カート内容クリア
  3. 購入完了メッセージ表示
- **出力**: 購入完了、カートクリア
- **業務ルール**:
  - 実際の決済処理は行わない
  - 確認ダイアログで最終金額表示
- **優先度**: 中

### 3.4 ToDoリスト機能

#### FR-013: Todo追加機能
- **要件ID**: FR-013
- **要件名**: お気に入りメモ追加
- **説明**: 商品に関するメモ（Todo）の追加
- **前提条件**: ログイン済み
- **入力**: メモテキスト、追加ボタン押下
- **処理**:
  1. ログイン状態確認
  2. 入力値検証（空文字チェック）
  3. Todoアイテム生成（ID、テキスト、完了状態、作成日時）
  4. localStorage保存
  5. 一覧表示更新
- **出力**: Todo追加、追加完了メッセージ
- **例外**:
  - 未ログイン時：エラーメッセージ
  - 空文字入力時：何も実行しない
- **業務ルール**:
  - ログイン必須機能
  - 空文字・空白のみは無効
- **優先度**: 中

#### FR-014: Todo完了切替機能
- **要件ID**: FR-014
- **要件名**: Todo完了状態切替
- **説明**: Todoアイテムの完了・未完了状態切替
- **前提条件**: Todoアイテム存在
- **入力**: チェックボタン（✅/↩️）押下
- **処理**:
  1. 対象Todoアイテム特定
  2. 完了状態の反転（true⇔false）
  3. localStorage更新
  4. 表示更新（取り消し線、アイコン変更）
- **出力**: 完了状態変更、UI更新
- **業務ルール**:
  - 完了状態は切替式
  - 完了時：取り消し線表示
- **優先度**: 低

#### FR-015: Todo削除機能
- **要件ID**: FR-015
- **要件名**: Todoアイテム削除
- **説明**: 不要なTodoアイテムの削除
- **前提条件**: Todoアイテム存在
- **入力**: 削除ボタン（🗑️）押下
- **処理**:
  1. 対象Todoアイテム特定
  2. リストから削除
  3. localStorage更新
  4. 表示更新
- **出力**: Todo削除、削除完了メッセージ
- **優先度**: 低

### 3.5 言語切り替え機能

#### FR-016: 言語切替機能
- **要件ID**: FR-016
- **要件名**: 日英言語切替
- **説明**: UIの表示言語を日本語・英語で切替
- **前提条件**: アプリケーションアクセス済み
- **入力**: 言語ボタン（EN/JP）押下
- **処理**:
  1. 言語選択取得
  2. i18nオブジェクトから翻訳データ取得
  3. UI要素の翻訳更新
  4. 商品名・カテゴリ名翻訳
  5. localStorage保存
- **出力**: UI言語変更
- **業務ルール**:
  - 対応言語: 日本語（ja）、英語（en）
  - デフォルト: 日本語
- **優先度**: 中

#### FR-017: 言語設定永続化機能
- **要件ID**: FR-017
- **要件名**: 言語設定の永続化
- **説明**: 言語選択をブラウザに保存・復元
- **前提条件**: 言語切替実行済み
- **入力**: ページリロード・再アクセス
- **処理**:
  1. localStorage内の言語設定確認
  2. 保存済み言語での表示復元
  3. 未設定時：デフォルト言語適用
- **出力**: 前回選択言語での表示
- **優先度**: 低

### 3.6 データ永続化機能

#### FR-018: データ永続化機能
- **要件ID**: FR-018
- **要件名**: ユーザーデータの永続化
- **説明**: ユーザー情報、カート、Todo、言語設定の保存・復元
- **前提条件**: データ変更操作実行
- **入力**: データ更新イベント
- **処理**:
  1. localStorage APIを使用
  2. JSON形式でのデータシリアライズ
  3. データ保存・読み込み
- **出力**: データ永続化
- **業務ルール**:
  - 保存対象: currentUser, cart, todos, language
  - 形式: JSON文字列
- **優先度**: 高

---

## 4. 非機能要件分析

### 4.1 性能要件

#### NFR-001: 応答時間要件
- **要件ID**: NFR-001
- **要件名**: 画面表示応答時間
- **説明**: ユーザー操作から画面更新までの応答時間
- **測定基準**:
  - 初期ページ表示: 3秒以内
  - ユーザー操作応答: 1秒以内
  - 商品検索・フィルタ: 0.5秒以内
- **測定条件**: 標準的な開発環境（ローカルサーバー）
- **優先度**: 中

#### NFR-002: 処理容量要件
- **要件ID**: NFR-002
- **要件名**: データ処理容量
- **説明**: アプリケーションが処理可能なデータ量
- **測定基準**:
  - 商品数: 12商品（固定）
  - カート商品数: 100商品まで
  - Todo数: 1000件まで
- **優先度**: 低

### 4.2 使いやすさ要件

#### NFR-003: ユーザビリティ要件
- **要件ID**: NFR-003
- **要件名**: 操作の簡単さ
- **説明**: 直感的で分かりやすい操作インターフェース
- **測定基準**:
  - 初回ユーザーのタスク完了率: 90%以上
  - 主要操作の発見可能性: 3クリック以内
  - エラー回復: 1操作で復旧可能
- **優先度**: 中

#### NFR-004: アクセシビリティ要件
- **要件ID**: NFR-004
- **要件名**: アクセシビリティ対応
- **説明**: 様々なユーザーが利用可能な設計
- **測定基準**:
  - WCAG 2.1 レベルAA準拠
  - キーボード操作対応
  - スクリーンリーダー対応
- **優先度**: 低

### 4.3 互換性要件

#### NFR-005: ブラウザ互換性要件
- **要件ID**: NFR-005
- **要件名**: マルチブラウザ対応
- **説明**: 主要ブラウザでの動作保証
- **対象ブラウザ**:
  - Chrome 60+: 完全対応
  - Firefox 55+: 完全対応
  - Safari 12+: 基本機能対応
  - Edge 79+: 基本機能対応
- **優先度**: 高

#### NFR-006: デバイス互換性要件
- **要件ID**: NFR-006
- **要件名**: レスポンシブデザイン
- **説明**: 様々な画面サイズでの表示対応
- **対象デバイス**:
  - デスクトップ: 1200px以上
  - タブレット: 768px-1199px
  - モバイル: 320px-767px
- **優先度**: 中

### 4.4 セキュリティ要件

#### NFR-007: 入力値検証要件
- **要件ID**: NFR-007
- **要件名**: 入力値のサニタイゼーション
- **説明**: XSS攻撃等を防ぐ入力値検証
- **対象項目**:
  - 商品検索入力
  - Todo入力
  - ログイン入力
- **優先度**: 中

#### NFR-008: データ保護要件
- **要件ID**: NFR-008
- **要件名**: ローカルデータの保護
- **説明**: localStorageデータの適切な管理
- **保護対象**:
  - パスワード情報の暗号化不要（デモ用途）
  - 個人情報の非保存
- **優先度**: 低

---

## 5. 制約条件

### 5.1 技術制約

#### TC-001: 技術スタック制約
- **制約名**: フロントエンド技術限定
- **内容**: Vanilla JavaScript, HTML5, CSS3のみ使用
- **理由**: 学習目的、シンプルな環境での実践
- **影響**: 複雑な状態管理、ルーティングは実装しない

#### TC-002: データベース制約
- **制約名**: ローカルストレージのみ使用
- **内容**: localStorage以外のデータ永続化手段なし
- **理由**: サーバーサイド実装なし
- **影響**: 大容量データ、複数ユーザーデータ共有不可

#### TC-003: ネットワーク制約
- **制約名**: 外部API利用なし
- **内容**: 外部サービス（決済、認証等）との連携なし
- **理由**: 学習・テスト環境での独立性確保
- **影響**: 実際の決済処理、ユーザー管理機能なし

### 5.2 ビジネス制約

#### BC-001: 予算制約
- **制約名**: 開発・運用コスト最小化
- **内容**: 追加コストをかけない実装
- **影響**: 高度な機能、有料サービス利用なし

#### BC-002: スケジュール制約
- **制約名**: 短期間での完成
- **内容**: 最小限の機能で最大の学習効果
- **影響**: 複雑な機能は実装しない

#### BC-003: ライセンス制約
- **制約名**: オープンソース利用
- **内容**: MIT Licenseでの公開
- **影響**: 商用制限のあるライブラリ使用不可

---

## 6. テストベース特定

### 6.1 機能要件テストベース
- **主要テストベース**: FR-001～FR-018（18項目）
- **高優先度**: FR-001, FR-008, FR-011, FR-018（認証、カート、永続化）
- **中優先度**: FR-004, FR-005, FR-016（商品表示、検索、言語切替）
- **低優先度**: FR-007, FR-014, FR-015（ソート、Todo操作）

### 6.2 非機能要件テストベース
- **主要テストベース**: NFR-001, NFR-005, NFR-006（性能、互換性）
- **補完テストベース**: NFR-003, NFR-007（ユーザビリティ、セキュリティ）

### 6.3 制約条件テストベース
- **技術制約検証**: ブラウザ互換性、localStorage制限
- **環境制約検証**: ローカル環境での動作確認

---

## 7. 要件トレーサビリティ

### 7.1 機能別要件マッピング

| 機能領域 | 機能要件 | 非機能要件 | 制約条件 |
|---------|---------|-----------|----------|
| 認証 | FR-001, FR-002, FR-003 | NFR-007 | TC-002 |
| 商品カタログ | FR-004, FR-005, FR-006, FR-007 | NFR-001 | TC-001 |
| カート | FR-008, FR-009, FR-010, FR-011, FR-012 | NFR-001, NFR-002 | TC-002 |
| Todo | FR-013, FR-014, FR-015 | NFR-002 | TC-002 |
| 言語切替 | FR-016, FR-017 | NFR-006 | TC-001 |
| データ永続化 | FR-018 | NFR-008 | TC-002 |

---

## 8. 要件品質評価

### 8.1 要件品質基準（ISO/IEC 25010準拠）
- **明確性**: ✅ 各要件が具体的に定義済み
- **完全性**: ✅ 主要機能の要件を網羅
- **一貫性**: ✅ 要件間の矛盾なし
- **検証可能性**: ✅ テスト可能な条件設定済み
- **修正可能性**: ✅ 独立性を保った要件設計

### 8.2 改善提案
1. **性能要件の具体化**: より詳細な性能基準設定
2. **エラー処理要件**: 異常系の要件明確化
3. **国際化要件**: 多言語対応の拡張要件

---

## 9. 改版履歴

| 版数 | 日付 | 変更内容 | 変更者 |
|------|------|----------|--------|
| 1.0 | 2025-09-21 | 初版作成 | Claude Code |

---

## 承認

| 役割 | 氏名 | 署名 | 日付 |
|------|------|------|------|
| 要件分析責任者 | [TBD] | [TBD] | [TBD] |
| テストアナリスト | [TBD] | [TBD] | [TBD] |
| 品質保証責任者 | [TBD] | [TBD] | [TBD] |