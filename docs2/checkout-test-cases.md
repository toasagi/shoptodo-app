# チェックアウト機能テストケース仕様書

## 1. 文書情報

**文書ID**: TC-CHECKOUT-001
**バージョン**: 1.0
**作成日**: 2025年9月29日
**関連文書**: TA-CHECKOUT-001 (テスト分析書)

## 2. テストケース一覧

### 2.1 正常系テストケース

#### TC-CHK-001: 正常なチェックアウトフロー完了

**優先度**: P0 (必須)
**前提条件**:
- ユーザーがログイン済み
- カートに商品が1つ以上存在

**テスト手順**:
1. チェックアウトボタンをクリック
2. 配送先情報を入力:
   - 名前: "山田太郎"
   - メール: "yamada@example.com"
   - 電話番号: "090-1234-5678"
   - 郵便番号: "100-0001"
   - 住所: "東京都千代田区千代田1-1"
3. 「次へ」をクリック
4. 支払い方法「クレジットカード」を選択
5. 「次へ」をクリック
6. 注文内容を確認
7. 「注文を確定」をクリック

**期待結果**:
- 注文完了画面が表示される
- 注文番号が表示される
- カートが空になる
- 注文が注文履歴に追加される

---

#### TC-CHK-002: 支払い方法の切り替え

**優先度**: P1 (高)
**前提条件**: TC-CHK-001のステップ3まで完了

**テスト手順**:
1. 支払い方法で「銀行振込」を選択
2. 「次へ」をクリック
3. 「戻る」をクリック
4. 支払い方法を「代金引換」に変更
5. 「次へ」をクリック

**期待結果**:
- 支払い方法が正しく変更される
- 注文確認画面に「代金引換」が表示される

---

#### TC-CHK-003: ステップ間のナビゲーション

**優先度**: P1 (高)
**前提条件**: ユーザーがログイン済み、カートに商品あり

**テスト手順**:
1. チェックアウトボタンをクリック
2. ステップ1で情報を入力し「次へ」
3. ステップ2で「戻る」をクリック
4. ステップ1の入力内容を確認
5. 再度「次へ」をクリック
6. ステップ2で支払い方法を選択し「次へ」
7. ステップ3で「戻る」を2回クリック

**期待結果**:
- 各ステップ間の遷移が正常に動作
- 入力データが保持される
- ステップインジケーターが正しく更新される

### 2.2 異常系テストケース

#### TC-CHK-004: 必須フィールド未入力

**優先度**: P1 (高)
**前提条件**: ユーザーがログイン済み、カートに商品あり

**テスト手順**:
1. チェックアウトボタンをクリック
2. 何も入力せずに「次へ」をクリック

**期待結果**:
- バリデーションエラーが表示される
- 次のステップに進めない
- エラーメッセージ: "この項目は必須です"

---

#### TC-CHK-005: 無効なメールアドレス形式

**優先度**: P1 (高)
**テストデータ**:
- "notanemail"
- "@example.com"
- "user@"
- "user@.com"

**テスト手順**:
1. チェックアウトボタンをクリック
2. 各テストデータをメールフィールドに入力
3. 他の必須フィールドは正常値を入力
4. 「次へ」をクリック

**期待結果**:
- バリデーションエラーが表示される
- エラーメッセージ: "有効なメールアドレスを入力してください"

---

#### TC-CHK-006: カートが空の状態でのチェックアウト

**優先度**: P0 (必須)
**前提条件**:
- ユーザーがログイン済み
- カートが空

**テスト手順**:
1. チェックアウトボタンの状態を確認

**期待結果**:
- チェックアウトボタンが無効化されている
- クリックしてもモーダルが開かない

---

#### TC-CHK-007: 文字数制限超過

**優先度**: P2 (中)
**テストデータ**:
- 名前: 101文字の文字列
- 住所: 201文字の文字列

**テスト手順**:
1. チェックアウトボタンをクリック
2. 名前フィールドに101文字入力
3. 住所フィールドに201文字入力

**期待結果**:
- 最大文字数で入力が制限される
- または適切なエラーメッセージが表示される

### 2.3 UI/UXテストケース

#### TC-CHK-008: モーダルのスクロール動作

**優先度**: P2 (中)
**前提条件**: 小さい画面サイズ（高さ600px以下）

**テスト手順**:
1. ブラウザウィンドウを高さ600pxに調整
2. チェックアウトモーダルを開く
3. モーダル内をスクロール

**期待結果**:
- モーダル内がスクロール可能
- すべてのボタンにアクセス可能
- モーダル外の背景はスクロールしない

---

#### TC-CHK-009: 多言語切り替え

**優先度**: P2 (中)
**前提条件**: チェックアウトモーダルが開いている

**テスト手順**:
1. 言語を日本語に設定
2. チェックアウトモーダルを開く
3. すべてのラベルが日本語であることを確認
4. 言語を英語に切り替え
5. すべてのラベルが英語に変わることを確認

**期待結果**:
- すべてのテキストが選択言語で表示される
- 入力データは保持される

### 2.4 注文履歴テストケース

#### TC-CHK-010: 注文履歴の表示

**優先度**: P1 (高)
**前提条件**: 1つ以上の注文が完了している

**テスト手順**:
1. 「注文履歴を見る」ボタンをクリック
2. 注文履歴モーダルを確認

**期待結果**:
- 注文履歴モーダルが表示される
- 注文が新しい順に表示される
- 各注文の詳細（注文番号、日付、商品、金額）が表示される

---

#### TC-CHK-011: 空の注文履歴

**優先度**: P2 (中)
**前提条件**: 注文履歴が0件

**テスト手順**:
1. 「注文履歴を見る」ボタンをクリック

**期待結果**:
- "注文履歴はありません"メッセージが表示される

---

#### TC-CHK-012: 注文データの永続化

**優先度**: P0 (必須)
**前提条件**: 注文を1つ完了済み

**テスト手順**:
1. ブラウザをリロード
2. ログイン
3. 注文履歴を確認

**期待結果**:
- 注文データが保持されている
- localStorageに注文データが存在する

## 3. トレーサビリティマトリックス

| 要件ID | テストケースID | カバレッジ |
|--------|----------------|------------|
| REQ-CHK-01 (チェックアウトフロー) | TC-CHK-001, TC-CHK-003 | 100% |
| REQ-CHK-02 (フォームバリデーション) | TC-CHK-004, TC-CHK-005, TC-CHK-007 | 100% |
| REQ-CHK-03 (支払い方法) | TC-CHK-001, TC-CHK-002 | 100% |
| REQ-CHK-04 (注文確認) | TC-CHK-001 | 100% |
| REQ-CHK-05 (注文履歴) | TC-CHK-010, TC-CHK-011 | 100% |
| REQ-CHK-06 (データ永続化) | TC-CHK-012 | 100% |
| REQ-CHK-07 (多言語対応) | TC-CHK-009 | 100% |
| REQ-CHK-08 (レスポンシブ) | TC-CHK-008 | 100% |

## 4. テスト実行順序

### リグレッションテスト順序
1. TC-CHK-006 (カート空チェック)
2. TC-CHK-001 (正常フロー)
3. TC-CHK-012 (データ永続化)
4. TC-CHK-004 (必須フィールド)
5. TC-CHK-005 (メールバリデーション)
6. TC-CHK-010 (注文履歴表示)

### スモークテスト対象
- TC-CHK-001 (正常フロー)
- TC-CHK-006 (カート空チェック)
- TC-CHK-012 (データ永続化)

## 5. テスト終了基準

- すべてのP0, P1テストケースが合格
- P2テストケースの80%以上が合格
- ブロッキングバグが0件